# Discussion: Understanding Pod Status Output

> Deep dive into `kubectl get pod -o yaml | grep -A20 "status:"` output

---

## Pod Phases vs Conditions vs STATUS Reasons

```
┌─────────────────────────────────────────────────────────────────────────┐
│           THREE DIFFERENT THINGS - DON'T CONFUSE THEM!                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  1. POD PHASE (.status.phase)                                           │
│     ─────────────────────────                                           │
│     A single value: Pending | Running | Succeeded | Failed | Unknown    │
│     → The high-level state of the entire pod                            │
│                                                                         │
│  2. POD CONDITIONS (.status.conditions[])                               │
│     ────────────────────────────────────                                │
│     A list of boolean checks (True/False):                              │
│     • PodScheduled        - Has a node been assigned?                   │
│     • Initialized         - Have init containers finished?              │
│     • PodReadyToStartContainers - Is the sandbox ready?                 │
│     • ContainersReady     - Are all containers healthy?                 │
│     • Ready               - Can this pod receive traffic?               │
│                                                                         │
│  3. STATUS REASONS (what kubectl shows in STATUS column)                │
│     ──────────────────────────────────────────────────                  │
│     Human-readable reasons displayed by `kubectl get pods`:             │
│     • ContainerCreating   - Setting up sandbox/pulling images           │
│     • ImagePullBackOff    - Can't pull container image                  │
│     • CrashLoopBackOff    - Container keeps crashing                    │
│     • Unschedulable       - No node can run the pod                     │
│     • PodInitializing     - Init containers running                     │
│     • Error, Completed, etc.                                            │
│                                                                         │
│     These come from containerStatuses[].state.waiting.reason            │
│     or from condition reasons - NOT from .status.phase!                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 1. Pod Phases (The 5 Official Values)

The `.status.phase` field has **exactly 5 possible values**:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         POD PHASES                                      │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────┐                              ┌─────────┐                  │
│   │ Pending │────────────────────────────▶│ Running  │                  │
│   └─────────┘                              └────┬────┘                  │
│                                                 │                       │
│                        ┌────────────────────────┼──────────────────┐    │
│                        │                        │                  │    │
│                        ▼                        ▼                  ▼    │
│                   ┌─────────┐            ┌───────────┐       ┌────────┐ │
│                   │Succeeded│            │  Failed   │       │Unknown │ │
│                   │ (exit 0)│            │(exit != 0)│       │(no node│ │
│                   └─────────┘            └───────────┘       │contact)│ │
│                                                              └────────┘ │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

| Phase | When It Occurs | What's Happening |
|-------|----------------|------------------|
| **Pending** | Pod accepted but not yet running | Waiting for scheduling, image pull, or init containers |
| **Running** | At least one container running | Main containers are executing |
| **Succeeded** | All containers exited with code 0 | Job/batch workload completed successfully |
| **Failed** | All containers terminated, at least one failed | Container crashed or exited with non-zero code |
| **Unknown** | Cannot determine pod state | Node communication lost, kubelet not responding |

### Checking Pod Phase

```bash
# Get current phase (only these 5 values possible)
kubectl get pod <pod-name> -o jsonpath='{.status.phase}'

# Watch phase changes
kubectl get pod <pod-name> -w
```

---

## 2. Pod Conditions (The 5 Boolean Checks)

The `.status.conditions[]` array contains **5 condition types**, each with `status: "True"/"False"/"Unknown"`:

| Condition Type | Question Being Asked |
|----------------|---------------------|
| `PodScheduled` | "Has a node been assigned?" |
| `Initialized` | "Have all init containers finished?" |
| `PodReadyToStartContainers` | "Is the pod sandbox ready?" |
| `ContainersReady` | "Are all containers healthy?" |
| `Ready` | "Can this pod receive traffic?" |

### Checking Pod Conditions

```bash
# List all conditions with their status
kubectl get pod <pod-name> -o jsonpath='{range .status.conditions[*]}{.type}: {.status}{"\n"}{end}'

# Check specific condition
kubectl get pod <pod-name> -o jsonpath='{.status.conditions[?(@.type=="Ready")].status}'
```

---

## 3. STATUS Reasons (What kubectl Shows)

When you run `kubectl get pods`, the **STATUS** column shows human-readable reasons:

```bash
$ kubectl get pods
NAME         READY   STATUS              RESTARTS   AGE
my-pod       0/1     ContainerCreating   0          5s
my-pod       0/1     ImagePullBackOff    0          30s
my-pod       0/1     CrashLoopBackOff    3          2m
my-pod       1/1     Running             0          5m
```

These STATUS values come from **multiple sources**:

| STATUS Shown | Source | Meaning |
|--------------|--------|---------|
| `ContainerCreating` | `containerStatuses[].state.waiting.reason` | Sandbox/image setup in progress |
| `ImagePullBackOff` | `containerStatuses[].state.waiting.reason` | Image pull failing, backing off |
| `ErrImagePull` | `containerStatuses[].state.waiting.reason` | Initial image pull failure |
| `CrashLoopBackOff` | `containerStatuses[].state.waiting.reason` | Container keeps crashing |
| `PodInitializing` | `initContainerStatuses[].state.waiting.reason` | Init containers running |
| `Unschedulable` | `conditions[?(@.type=="PodScheduled")].reason` | No node can run the pod |
| `Running` | Derived from phase + container states | Pod is running normally |
| `Completed` | `containerStatuses[].state.terminated.reason` | Container finished (exit 0) |
| `Error` | `containerStatuses[].state.terminated.reason` | Container failed (exit != 0) |

---

## Phase Transitions

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    PHASE TRANSITION TRIGGERS                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Pending → Running                                                      │
│  ─────────────────                                                      │
│  • Node assigned (PodScheduled = True)                                  │
│  • Images pulled successfully                                           │
│  • Init containers completed (Initialized = True)                       │
│  • At least one container started                                       │
│                                                                         │
│  Running → Succeeded                                                    │
│  ────────────────────                                                   │
│  • All containers exit with code 0                                      │
│  • restartPolicy: Never or OnFailure (won't restart)                    │
│  • Typical for Jobs and batch workloads                                 │
│                                                                         │
│  Running → Failed                                                       │
│  ─────────────────                                                      │
│  • Container exits with non-zero code                                   │
│  • restartPolicy: Never (won't restart)                                 │
│  • Or: exceeded restart limit with OnFailure                            │
│                                                                         │
│  Any → Unknown                                                          │
│  ────────────                                                           │
│  • Node stops responding to API server                                  │
│  • Network partition between node and control plane                     │
│  • Kubelet crashes or stops reporting                                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### Common STATUS Reasons While Pending

When a pod's phase is `Pending`, the STATUS column shows **reasons** (not phases!):

| STATUS Reason | Source | Cause | Solution |
|---------------|--------|-------|----------|
| `Unschedulable` | Condition reason | No node can run the pod | Check resources, taints, node selectors |
| `ContainerCreating` | Container state | Setting up sandbox/pulling image | Wait, or check CNI/volume issues |
| `ImagePullBackOff` | Container state | Cannot pull container image | Verify image name, registry credentials |
| `ErrImagePull` | Container state | Initial image pull failure | Check network, image exists |
| `PodInitializing` | Init container state | Init containers running | Wait for init containers to complete |

---

## The Status Block Structure

```yaml
status:                   # Everything about "what's happening right now"
  conditions:             # List of health checks (is pod ready?)
  containerStatuses:      # State of each container
```

---

## Pod Conditions Explained

Each condition follows this structure:

```yaml
- lastProbeTime: null                        # When was this last checked (null = not probe-based)
  lastTransitionTime: "2026-01-26T08:54:58Z" # When did this status CHANGE
  observedGeneration: 1                      # Which version of pod spec this applies to
  status: "True"                             # The answer: "True", "False", or "Unknown"
  type: PodScheduled                         # The question being asked
```

### The 5 Conditions (in order they happen)

| Type | Question Being Asked |
|------|---------------------|
| `PodScheduled` | "Has a node been assigned?" |
| `Initialized` | "Have all init containers finished?" |
| `PodReadyToStartContainers` | "Is the pod sandbox ready?" |
| `ContainersReady` | "Are all containers healthy?" |
| `Ready` | "Can this pod receive traffic?" |

---

## Container Status Fields

```yaml
containerStatuses:
  - name: phase-demo          # Container name (from your spec)

    # ─── Identity ───
    containerID: containerd://4e42f6ee...   # Unique ID from container runtime
    image: docker.io/library/nginx:1.25     # Image used
    imageID: docker.io/library/nginx@sha256:a484...  # Exact image digest

    # ─── Health ───
    ready: true               # Is container passing readiness checks?
    started: true             # Has container started successfully?
    restartCount: 0           # How many times has it crashed and restarted?

    # ─── Current State ───
    state:
      running:                # One of: running, waiting, terminated
        startedAt: "2026-01-26T08:54:59Z"

    # ─── Previous State ───
    lastState: {}             # Empty = never restarted
                              # If crashed before, shows previous state

    # ─── Resources ───
    resources: {}             # Runtime resource info

    # ─── Security Context ───
    user:
      linux:
        gid: 0                # Group ID (0 = root)
        uid: 0                # User ID (0 = root)
        supplementalGroups:
        - 0
```

---

## The Three Container States

```
┌─────────────────────────────────────────────────────────────────────┐
│                    CONTAINER STATE OPTIONS                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  state:                   state:                   state:           │
│    waiting:                 running:                 terminated:    │
│      reason: "..."           startedAt: "..."        exitCode: 0    │
│      message: "..."                                  reason: "..."  │
│                                                      startedAt: ..  │
│                                                      finishedAt: .. │
│                                                                     │
│  Examples:                Examples:                Examples:        │
│  • ImagePullBackOff       • Container is           • Completed (0)  │
│  • CrashLoopBackOff         running normally       • Error (1)      │
│  • ContainerCreating                               • OOMKilled (137)│
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## Example Output Decoded

Given this output:

```yaml
status:
  conditions:
  - lastTransitionTime: "2026-01-26T08:54:58Z"
    status: "True"
    type: PodScheduled
  - lastTransitionTime: "2026-01-26T08:54:58Z"
    status: "True"
    type: Initialized
  - lastTransitionTime: "2026-01-26T08:55:00Z"
    status: "True"
    type: PodReadyToStartContainers
  - lastTransitionTime: "2026-01-26T08:55:00Z"
    status: "True"
    type: ContainersReady
  - lastTransitionTime: "2026-01-26T08:55:00Z"
    status: "True"
    type: Ready
  containerStatuses:
  - name: phase-demo
    ready: true
    started: true
    restartCount: 0
    state:
      running:
        startedAt: "2026-01-26T08:54:59Z"
```

**Summary:**

```
Condition: PodScheduled      = True  @ 08:54:58  → Node assigned
Condition: Initialized       = True  @ 08:54:58  → No init containers (instant)
Condition: PodReadyToStart   = True  @ 08:55:00  → Sandbox ready
Condition: ContainersReady   = True  @ 08:55:00  → nginx healthy
Condition: Ready             = True  @ 08:55:00  → Pod can serve traffic

Container: phase-demo
  - State: running since 08:54:59
  - Ready: true
  - Restarts: 0
  - Running as: root (uid=0)
```

---

## The Timestamp Puzzle

Looking at the timestamps:

```
PodScheduled              @ 08:54:58  (1st)
Initialized               @ 08:54:58  (1st - same time)
PodReadyToStartContainers @ 08:55:00  (3rd)
ContainersReady           @ 08:55:00  (3rd - same time)
Ready                     @ 08:55:00  (3rd - same time)

Container started         @ 08:54:59  (2nd)
```

**Wait - the container started BEFORE `PodReadyToStartContainers`?**

### Why This Happens

```
┌─────────────────────────────────────────────────────────────────────┐
│                    ACTUAL SEQUENCE                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  08:54:58  Pod scheduled to node, no init containers → Initialized  │
│       │                                                             │
│       ▼                                                             │
│  08:54:58  Kubelet starts creating sandbox (network, etc.)          │
│       │                                                             │
│       ▼                                                             │
│  08:54:59  Container starts running (sandbox was ready enough)      │
│       │                                                             │
│       ▼                                                             │
│  08:55:00  Kubelet reports back: "sandbox fully ready"              │
│            + "container ready" + "pod ready"                        │
│            (all conditions updated in same sync cycle)              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Key Insight

The `lastTransitionTime` is when the **API server recorded** the condition change, not when it actually happened.

The kubelet syncs conditions periodically (every few seconds), so:

1. Container actually started at `08:54:59`
2. Kubelet synced all the condition updates at `08:55:00`

**The timestamps reflect reporting time, not event time.**

The container's `startedAt: 08:54:59` is more accurate because it comes directly from the container runtime.

### Correct Mental Model

```
Real sequence:
  Schedule → Sandbox ready → Container starts → Conditions synced

What timestamps show:
  Schedule(58) → Container(59) → All conditions(00)
                                 ↑
                                 Kubelet sync delay
```

---

## Debugging with Conditions

When debugging, check conditions in order:

| Condition | If False | What to Check |
|-----------|----------|---------------|
| `PodScheduled` | Scheduler can't place pod | Resources, taints, node selectors |
| `Initialized` | Init container stuck/failing | `kubectl logs <pod> -c <init-container>` |
| `PodReadyToStartContainers` | Sandbox creation failed | Node issues, CNI problems |
| `ContainersReady` | Main container not healthy | `containerStatuses.state` for reason |
| `Ready` | Readiness probe failing | Check probe config, app health |

---

## Common Failure States

### Container stuck pulling image

```yaml
state:
  waiting:
    reason: ImagePullBackOff
    message: "Back-off pulling image nginx:wrong-tag"
```

### Container crashing repeatedly

```yaml
state:
  waiting:
    reason: CrashLoopBackOff
lastState:
  terminated:
    exitCode: 1
    reason: Error
restartCount: 5
```

### Container killed by OOM

```yaml
lastState:
  terminated:
    exitCode: 137
    reason: OOMKilled
```

---

## Why Conditions Are Not Sorted

When you run `kubectl get pod -o yaml`, you might notice conditions appear in a seemingly random order:

```yaml
conditions:
- type: PodReadyToStartContainers   # Not first chronologically
- type: Initialized                  # This happened earlier!
- type: Ready
- type: ContainersReady
- type: PodScheduled                 # This was actually first
```

### The Order is Undefined

According to [Kubernetes documentation](https://superorbital.io/blog/status-and-conditions/):

> "The Conditions in a Pod aren't in any particular order"

The order depends on:

1. **Which component updated it** - Kubelet vs kube-controller-manager
2. **When the sync happened** - Different components update at different intervals
3. **Implementation details** - Can vary between K8s versions

There's even a [known issue](https://github.com/kubernetes/kubernetes/issues/119514) where `lastTransitionTime` can get rolled back because the `Ready` condition is updated by **both** kubelet and kube-controller-manager.

### Key Takeaway

**Never rely on condition order.** Always look at:

- `type` field to identify the condition
- `lastTransitionTime` to understand timing
- `status` to check current state

---

## Displaying Conditions Chronologically

Since kubectl doesn't sort conditions, here are ways to see them in order:

### Option 1: Using `jq` (Recommended)

```bash
# Simple sorted list
kubectl get pod <pod-name> -o json | jq -r '
  .status.conditions
  | sort_by(.lastTransitionTime)[]
  | [.lastTransitionTime, .type, .status]
  | @tsv'
```

Output:

```text
2026-01-26T08:54:58Z    Initialized             True
2026-01-26T08:54:58Z    PodScheduled            True
2026-01-26T08:55:00Z    ContainersReady         True
2026-01-26T08:55:00Z    PodReadyToStartContainers    True
2026-01-26T08:55:00Z    Ready                   True
```

### Option 2: Using `jsonpath` + `sort`

```bash
kubectl get pod <pod-name> -o jsonpath='{range .status.conditions[*]}{.lastTransitionTime}{"\t"}{.type}{"\n"}{end}' | sort
```

### Option 3: Pretty table with `jq`

```bash
kubectl get pod <pod-name> -o json | jq -r '
  ["TIME", "CONDITION", "STATUS"],
  (.status.conditions | sort_by(.lastTransitionTime)[] | [.lastTransitionTime, .type, .status])
  | @tsv' | column -t
```

Output:

```text
TIME                   CONDITION                  STATUS
2026-01-26T08:54:58Z   Initialized                True
2026-01-26T08:54:58Z   PodScheduled               True
2026-01-26T08:55:00Z   ContainersReady            True
2026-01-26T08:55:00Z   PodReadyToStartContainers  True
2026-01-26T08:55:00Z   Ready                      True
```

---

## Events: The True Timeline

For a true chronological view of pod lifecycle, use **events** instead of conditions:

```bash
kubectl get events --field-selector involvedObject.name=<pod-name> --sort-by='.lastTimestamp'
```

Events are designed to be chronological and provide a detailed log of what happened:

```bash
# Example output
LAST SEEN   TYPE     REASON      MESSAGE
2s          Normal   Scheduled   Successfully assigned default/nginx to node1
1s          Normal   Pulling     Pulling image "nginx:1.25"
1s          Normal   Pulled      Successfully pulled image "nginx:1.25"
1s          Normal   Created     Created container nginx
1s          Normal   Started     Started container nginx
```

---

## Quick Reference: Exit Codes

| Exit Code | Meaning |
|-----------|---------|
| `0` | Success (normal exit) |
| `1` | General error |
| `137` | SIGKILL (OOMKilled or `kubectl delete`) |
| `143` | SIGTERM (graceful shutdown) |
| `139` | Segmentation fault |

---

## Related

- [1.4 Pod Lifecycle](1.4_pod_lifecycle.md) — Hands-on labs for pod lifecycle

---

*Discussion for Lab 1 of 1.4 Pod Lifecycle - Kubernetes 101: From Zero to Production*
