# What is a Deployment?

Understanding Deployments from absolute basics.

---

## Starting Point: What is a Container?

A container is a packaged application with everything it needs to run.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Container             â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Your App (e.g., nginx)   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Libraries & Dependencies â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Minimal OS files         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  Isolated, portable, runnable  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Level 1: What is a Pod?

A **Pod** is the smallest unit Kubernetes manages. It wraps one or more containers.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              POD                    â”‚
â”‚                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚ Container â”‚  â† usually one      â”‚
â”‚   â”‚  (nginx)  â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                     â”‚
â”‚   â€¢ Has its own IP address          â”‚
â”‚   â€¢ Can be created/destroyed        â”‚
â”‚   â€¢ Is EPHEMERAL (temporary)        â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**You can create a pod directly:**

```bash
kubectl run my-nginx --image=nginx
```

**Problem:** If this pod crashes or the node dies, it's gone forever. Nobody recreates it.

---

## Level 2: Why Do We Need a Deployment?

Imagine you're running a website. You need:

| Need | Problem with bare Pods |
|------|------------------------|
| **High availability** | If pod dies, website is down |
| **Scaling** | Manually create more pods? |
| **Updates** | Delete old, create new, hope nothing breaks? |
| **Rollback** | How do you go back if update fails? |

**A Deployment solves all of these.**

---

## What is a Deployment?

A **Deployment** is a controller that manages pods for you.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DEPLOYMENT                             â”‚
â”‚                       name: "web"                            â”‚
â”‚                                                              â”‚
â”‚   Desired State:                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  "I want 3 pods running nginx:latest at all times"  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚   Controller Loop (runs forever):                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  1. How many pods exist?                            â”‚   â”‚
â”‚   â”‚  2. Compare to desired (3)                          â”‚   â”‚
â”‚   â”‚  3. Create or delete pods to match                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚   Manages:                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚  Pod 1  â”‚    â”‚  Pod 2  â”‚    â”‚  Pod 3  â”‚                 â”‚
â”‚   â”‚  nginx  â”‚    â”‚  nginx  â”‚    â”‚  nginx  â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment in Action: Self-Healing

```
SCENARIO: Pod 2 crashes

Before:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod 1  â”‚    â”‚  Pod 2  â”‚    â”‚  Pod 3  â”‚
â”‚   âœ“     â”‚    â”‚   âœ“     â”‚    â”‚   âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ ğŸ’¥ CRASH!
                    â–¼

During crash:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod 1  â”‚    â”‚  Pod 2  â”‚    â”‚  Pod 3  â”‚
â”‚   âœ“     â”‚    â”‚   âœ—     â”‚    â”‚   âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”‚
                    â”‚ Deployment notices: "I have 2 pods, I need 3!"
                    â”‚ Deployment creates new pod
                    â–¼

After (automatic):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod 1  â”‚    â”‚  Pod 4  â”‚    â”‚  Pod 3  â”‚
â”‚   âœ“     â”‚    â”‚   âœ“     â”‚    â”‚   âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 (new!)
```

**You did nothing.** The Deployment controller automatically fixed it.

---

## Deployment in Action: Scaling

```bash
# Start with 3
kubectl create deployment web --image=nginx --replicas=3

# Scale to 5
kubectl scale deployment web --replicas=5

# Scale down to 2
kubectl scale deployment web --replicas=2
```

```
replicas=3:     [Pod] [Pod] [Pod]

replicas=5:     [Pod] [Pod] [Pod] [Pod] [Pod]

replicas=2:     [Pod] [Pod]
```

---

## Deployment in Action: Updates (Rolling Update)

```bash
# Update nginx from 1.19 to 1.20
kubectl set image deployment/web nginx=nginx:1.20
```

```
Step 1: Start new pod with v1.20
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ v1.19   â”‚ â”‚ v1.19   â”‚ â”‚ v1.19   â”‚ â”‚ v1.20   â”‚
â”‚   âœ“     â”‚ â”‚   âœ“     â”‚ â”‚   âœ“     â”‚ â”‚ startingâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: v1.20 is ready, terminate one v1.19
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ v1.19   â”‚ â”‚ v1.19   â”‚ â”‚ v1.19   â”‚ â”‚ v1.20   â”‚
â”‚   âœ“     â”‚ â”‚   âœ“     â”‚ â”‚ stoppingâ”‚ â”‚   âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

... continues until ...

Final: All pods are v1.20
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ v1.20   â”‚ â”‚ v1.20   â”‚ â”‚ v1.20   â”‚
â”‚   âœ“     â”‚ â”‚   âœ“     â”‚ â”‚   âœ“     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Zero downtime!** Old pods serve traffic until new ones are ready.

---

## Deployment in Action: Rollback

```bash
# Oh no, v1.20 has a bug! Go back!
kubectl rollout undo deployment/web
```

Kubernetes remembers previous versions and can instantly revert.

---

## Pod vs Deployment: Comparison

| Aspect | Pod (alone) | Deployment |
|--------|-------------|------------|
| **Self-healing** | âœ— Dies and stays dead | âœ“ Automatically replaced |
| **Scaling** | âœ— Manual | âœ“ `kubectl scale` |
| **Updates** | âœ— Delete & recreate | âœ“ Rolling updates |
| **Rollback** | âœ— Manual | âœ“ `kubectl rollout undo` |
| **Use case** | One-off tasks, debugging | Production workloads |

---

## Analogy: Restaurant Kitchen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚   DEPLOYMENT = Head Chef                                     â”‚
â”‚   "I need 3 cooks on the line at all times"                 â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚ Cook 1  â”‚    â”‚ Cook 2  â”‚    â”‚ Cook 3  â”‚   = Pods        â”‚
â”‚   â”‚ (works) â”‚    â”‚ (works) â”‚    â”‚ (works) â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                              â”‚
â”‚   If Cook 2 calls in sick:                                  â”‚
â”‚   Head Chef (Deployment) finds a replacement automatically  â”‚
â”‚                                                              â”‚
â”‚   If restaurant gets busy:                                  â”‚
â”‚   Head Chef adds more cooks (scaling)                       â”‚
â”‚                                                              â”‚
â”‚   If cooks need new training:                               â”‚
â”‚   Head Chef trains them one at a time (rolling update)      â”‚
â”‚   so kitchen never stops                                    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Command Explained

```bash
kubectl create deployment web --image=nginx --replicas=3
```

| Part | Meaning |
|------|---------|
| `kubectl` | CLI tool to talk to Kubernetes |
| `create deployment` | Create a new Deployment resource |
| `web` | Name of the deployment |
| `--image=nginx` | Use the nginx container image |
| `--replicas=3` | Maintain 3 pods at all times |

**What Kubernetes does:**
1. Creates a Deployment object named "web"
2. Deployment controller sees it and creates 3 pods
3. Controller watches forever, ensuring 3 pods always exist

---

## Try It Yourself

```bash
# Create deployment
kubectl create deployment web --image=nginx --replicas=3

# See the deployment
kubectl get deployment web

# See the pods it created
kubectl get pods -l app=web

# Delete a pod and watch it come back
kubectl delete pod <pod-name>
kubectl get pods -l app=web   # A new one appears!
```

---

## What's Next?

Now that you understand Deployments, the next step is understanding **Services** - how other pods can reliably communicate with your deployment's pods.

See: [0.5.2_what_is_a_service.md](./0.5.2_what_is_a_service.md)
