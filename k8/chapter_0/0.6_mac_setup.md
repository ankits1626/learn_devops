# 0.6 Mac Setup (Podman, kubectl, kind)

> **Last validated:** January 2026 | kind v0.31.0 | Podman 5.x | kubectl 1.31+

## Goal

Get your Mac ready to run Kubernetes locally. By the end of this section, you'll have all the tools installed and configured.

---

## Prerequisites

Before starting, make sure you have:

- Mac with 8GB+ RAM (16GB recommended)
- macOS 13+ (Ventura or newer recommended for Apple Silicon)
- Homebrew installed
- Apple Silicon (M1/M2/M3) or Intel Mac

**Check if Homebrew is installed:**

```bash
brew --version
```

If not installed:

```bash
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
```

---

## Tools We'll Install

| Tool | What It Does | Why We Need It |
|------|--------------|----------------|
| **Podman** | Runs containers | The engine that runs containers (like Docker, but free) |
| **kubectl** | Talks to Kubernetes | CLI to control your cluster |
| **kind** | Creates local clusters | Runs K8s inside containers on your Mac |
| **k9s** | Terminal UI for K8s | Makes it easier to see what's happening |
| **kubectx** | Switch contexts | Quickly switch between clusters |

---

## Step 1: Install Podman

Podman is our container runtime. It's like Docker but:
- Free for commercial use
- Runs without a daemon (background service)
- More secure (rootless by default)

```bash
# Install Podman
brew install podman
```

**Initialize and start the Podman machine:**

```bash
# Create a Podman VM with rootful mode and adequate resources
# (rootful is required for kind to work properly)
podman machine init --rootful --cpus 4 --memory 4096 --disk-size 60

# Start the machine
podman machine start
```

**Alternative: If you already have a Podman machine:**

```bash
# Stop existing machine
podman machine stop

# Enable rootful mode
podman machine set --rootful

# Optionally increase resources
podman machine set --cpus 4 --memory 4096

# Start the machine
podman machine start
```

**Verify it works:**

```bash
# Check Podman is running
podman machine list

# Test with hello-world
podman run hello-world
```

You should see:

```text
Hello from Podman!
This message shows that your installation appears to be working correctly.
...
```

> **Note:** Rootful mode is required for kind because kind needs to create nested containers and configure networking, which requires elevated privileges.

---

## Step 2: Install kubectl

kubectl (pronounced "cube-control" or "cube-cuddle") is the CLI for Kubernetes.

```bash
brew install kubectl
```

**Verify:**

```bash
kubectl version --client
```

You should see something like:

```text
Client Version: v1.31.0
Kustomize Version: v5.4.2
```

---

## Step 3: Install kind

kind = **K**ubernetes **IN** **D**ocker (or Podman in our case)

It creates a full Kubernetes cluster using containers as nodes. Current stable version is **v0.31.0**.

```bash
brew install kind
```

**Verify:**

```bash
kind version
```

Expected output:

```text
kind v0.31.0 go1.23.x darwin/arm64
```

---

## Step 4: Install k9s (Optional but Recommended)

k9s is a terminal UI that makes it much easier to see what's happening in your cluster.

```bash
brew install derailed/k9s/k9s
```

**Verify:**

```bash
k9s version
```

---

## Step 5: Install kubectx & kubens (Optional but Helpful)

These tools make switching between clusters and namespaces easier.

```bash
brew install kubectx
```

This installs both:
- `kubectx` - switch between clusters
- `kubens` - switch between namespaces

---

## Step 6: Configure Your Shell

Add these aliases and settings to your shell config.

**Open your shell config:**

```bash
# For zsh (default on Mac)
nano ~/.zshrc

# Or for bash
nano ~/.bashrc
```

**Add these lines:**

```bash
# ===========================================
# Kubernetes Configuration
# ===========================================

# Tell kind to use Podman instead of Docker
export KIND_EXPERIMENTAL_PROVIDER=podman

# Shorter alias for kubectl
alias k=kubectl

# Common kubectl shortcuts
alias kgp='kubectl get pods'
alias kgpa='kubectl get pods -A'
alias kgs='kubectl get services'
alias kgd='kubectl get deployments'
alias kgn='kubectl get nodes'
alias kga='kubectl get all'
alias kd='kubectl describe'
alias kl='kubectl logs'
alias kaf='kubectl apply -f'
alias kdf='kubectl delete -f'

# Enable kubectl autocompletion
source <(kubectl completion zsh)

# Make 'k' alias work with autocompletion
complete -o default -F __start_kubectl k
```

**Apply the changes:**

```bash
source ~/.zshrc
```

---

## Step 7: Verify Everything Works

Run this quick check:

```bash
# Check Podman
podman --version

# Check kubectl
kubectl version --client

# Check kind
kind version

# Check Podman machine is running
podman machine list
```

Expected output (versions may vary):

```text
podman version 5.3.0
Client Version: v1.31.0
kind v0.31.0 go1.23.2 darwin/arm64

NAME                     VM TYPE     CREATED        LAST UP            CPUS        MEMORY      DISK SIZE
podman-machine-default*  applehv     2 minutes ago  Currently running  4           4GiB        60GiB
```

---

## Troubleshooting

### Podman machine won't start

```bash
# Stop and restart
podman machine stop
podman machine start

# If that doesn't work, recreate it
podman machine rm
podman machine init --rootful --cpus 4 --memory 4096
podman machine start
```

### "Cannot connect to Podman" errors

Make sure the machine is running:

```bash
podman machine list
# Should show "Currently running"
```

### kubectl not finding cluster

This is expected - we haven't created a cluster yet! That's the next section.

### Permission denied errors

Make sure you set rootful mode:

```bash
podman machine stop
podman machine set --rootful
podman machine start
```

### kind cluster creation fails

If you see errors about cgroups or networking:

```bash
# Verify Podman is in rootful mode
podman machine inspect | grep -i rootful
# Should show: "Rootful": true

# Check cgroup version (should be v2)
podman info | grep -i cgroup
# Should show: cgroupVersion: v2
```

### "too many open files" or PID limit errors

kind nodes may hit process limits. Create or edit `~/.config/containers/containers.conf`:

```toml
[containers]
pids_limit = 0
```

Then restart Podman:

```bash
podman machine stop
podman machine start
```

---

## What We Installed

```text
┌─────────────────────────────────────────────────────────────────┐
│                    YOUR MAC SETUP                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                    Your Terminal                        │   │
│   │                                                         │   │
│   │   kubectl ──────┐                                       │   │
│   │   k9s    ───────┼────▶  Kubernetes Cluster              │   │
│   │   kubectx ──────┘       (created by kind)               │   │
│   │                              │                          │   │
│   │                              │                          │   │
│   │                              ▼                          │   │
│   │                     ┌─────────────────┐                 │   │
│   │                     │     Podman      │                 │   │
│   │                     │   (Container    │                 │   │
│   │                     │    Runtime)     │                 │   │
│   │                     └─────────────────┘                 │   │
│   │                                                         │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Quick Reference Card

```bash
# Podman commands
podman machine start          # Start Podman VM
podman machine stop           # Stop Podman VM
podman machine list           # Check status
podman ps                     # List running containers
podman images                 # List images

# kind commands (we'll use these next)
kind create cluster           # Create a cluster
kind delete cluster           # Delete a cluster
kind get clusters             # List clusters

# kubectl commands (we'll use these a lot)
kubectl get nodes             # List nodes
kubectl get pods              # List pods
kubectl get all               # List everything
```

---

## Checklist

Before moving on, verify:

- [ ] `podman --version` shows version info
- [ ] `podman machine list` shows "Currently running"
- [ ] `kubectl version --client` shows version info
- [ ] `kind version` shows version info
- [ ] Shell aliases work (`k get nodes` - will error, but command runs)

---

## References

- [kind Official Documentation](https://kind.sigs.k8s.io/)
- [kind with Podman - Podman Desktop](https://podman-desktop.io/docs/kind)
- [Install kubectl on macOS - Kubernetes Docs](https://kubernetes.io/docs/tasks/tools/install-kubectl-macos/)
- [Set up Kubernetes on Mac 2025 - Cloudurable](https://cloudurable.com/blog/kubernetes_k8s_osx_setup_brew-2025/)
- [How to Set Up Kubernetes Locally in 2025 - Medium](https://medium.com/@josephsims1/how-to-set-up-kubernetes-locally-in-2025-podman-kind-and-more-841b8e6c4dc1)
- [Podman Machine Documentation](https://docs.podman.io/en/latest/markdown/podman-machine-init.1.html)

---

**Next:** [0.7 Your First Cluster](./0.7_first_cluster.md) - Let's create a real Kubernetes cluster!
